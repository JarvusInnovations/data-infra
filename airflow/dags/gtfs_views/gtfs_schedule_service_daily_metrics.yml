operator: operators.SqlToWarehouseOperator
dst_table_name: "views.gtfs_schedule_service_daily_metrics"
dependencies:
  - warehouse_loaded

sql: |
  SELECT
    calitp_itp_id
    , calitp_url_number
    , service_date
    , service_id
    , SUM(service_hours) AS ttl_service_hours
  FROM `{{ "views.gtfs_schedule_service_daily_trips" | table }}`
  GROUP BY 1, 2, 3, 4
